# Story 2.5: Add Farm Wizard

**Epic:** Frontend Application (Next.js)

## Status
Completed

## Story
**As a** User,
**I want** a multi-step wizard to add a new wind farm,
**so that** I am guided through the process and don't omit required information.

---

## Acceptance Criteria

1. **AC1:** An "Add Farm" button on the farm list page opens the Wizard.
2. **AC2:** The Wizard is implemented as a multi-step form:
    - **Step 1: Identity**: Project Name, SPV, Code.
    - **Step 2: Type**: Select Farm Type (Wind, Solar, Hybrid).
    - **Step 3: Review**: Summary of entered data before submission.
3. **AC3:** Form validation ensures required fields are filled before moving to the next step.
4. **AC4:** The "Code" field must be unique (checked by backend on submission).
5. **AC5:** On successful submission, the new farm is created via `POST /farms` and the user is redirected to the new farm's detail page.
6. **AC6:** Users can cancel the process at any time via the "Back" button or navigation.

---

## Tasks / Subtasks

- [x] **Task 1: Create Add Farm Page** (AC1, AC6)
  - [x] Create `frontend/src/app/farms/new/page.tsx`
  - [x] Implement visual step indicator and breadcrumbs

- [x] **Task 2: Build Step 1 - Identity** (AC2)
  - [x] Create manual `Input` component in `frontend/src/components/ui/input.tsx`
  - [x] Implement identity fields with state management and validation

- [x] **Task 3: Build Step 2 - Type** (AC2)
  - [x] Create manual `Select` component in `frontend/src/components/ui/select.tsx`
  - [x] Implement energy type selection

- [x] **Task 4: Build Step 3 - Review & Submit** (AC2, AC5)
  - [x] Display a summarized review card
  - [x] Implement backend submission with error handling
  - [x] Redirect to the details page of the newly created farm

---

## Dev Notes

### UI Components
- Added `Input` and `Select` components to our custom library.
- Used a responsive multi-step progress bar to guide the user.

### Backend Integration
- Integrated with `POST /farms`.
- Handled potential errors such as "Farm with this code already exists" (409 Conflict).

---

## Testing

- **Manual Verification**: 
  - Navigated from list to "Add Farm".
  - Verified step validation (cannot proceed without fields).
  - Successfully created a farm and verified redirect to detail view.
  - Verified cancellation returns to the list.

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-05 | 1.0 | Initial story creation | Dev Agent |
| 2026-02-05 | 1.1 | Implementation completed and verified | Dev Agent |

---

## Dev Agent Record

### Agent Model Used
Gemini 2.0 Flash

### File List
- `frontend/src/components/ui/input.tsx`
- `frontend/src/components/ui/select.tsx`
- `frontend/src/app/farms/new/page.tsx`
- `frontend/src/app/farms/page.tsx` (updated)
- `docs/stories/2.5.story.md`